@import "tailwindcss";

/* Custom component styles */
@layer components {
  .card {
  @apply bg-white/80 dark:bg-gray-800/80 rounded-2xl border border-white/20 dark:border-gray-700/50 backdrop-blur-xl duration-300;
  transition-property: transform, background-color, border-color, opacity;
  }

  .card:hover {
  /* removed transform lift to avoid mixing with shadows on same layer (macOS CoreAnimation warning) */
  /* avoid animating box-shadow on transformed layers */
  }

  .card-glass {
  @apply bg-white/10 dark:bg-gray-900/20 rounded-2xl border border-white/20 dark:border-gray-700/30 backdrop-blur-2xl;
  }

  .card-body {
    @apply px-8 py-6;
  }

  .btn-primary {
  @apply inline-flex items-center justify-center px-6 py-3 text-sm font-semibold rounded-xl bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white focus:ring-4 focus:ring-blue-500/50 duration-300 disabled:opacity-50 disabled:cursor-not-allowed backdrop-blur-sm;
  transition-property: transform, background-color, border-color, opacity, color;
  }

  .btn-primary:hover {
  /* removed transform lift to avoid shadow+transform on same element */
  }

  .btn-danger {
  @apply inline-flex items-center justify-center px-6 py-3 text-sm font-semibold rounded-xl bg-gradient-to-r from-red-600 to-pink-600 hover:from-red-700 hover:to-pink-700 text-white focus:ring-4 focus:ring-red-500/50 duration-300 disabled:opacity-50 disabled:cursor-not-allowed backdrop-blur-sm;
  transition-property: transform, background-color, border-color, opacity, color;
  }

  .btn-danger:hover {
  /* removed transform lift to avoid shadow+transform on same element */
  }

  .text-gradient {
    @apply bg-gradient-to-r from-blue-600 via-purple-600 to-indigo-600 bg-clip-text text-transparent;
  }

  .sidebar {
    @apply fixed top-0 left-0 h-full w-64 bg-gradient-to-b from-gray-900 via-blue-900 to-indigo-900 transform transition-transform duration-300 ease-in-out z-50;
    backdrop-filter: blur(20px);
  }

  .sidebar-open {
    transform: translateX(0);
  }

  .glass-dark {
    @apply bg-gray-900/80 backdrop-blur-2xl;
    border: 1px solid rgba(255, 255, 255, 0.1);
  }

  .notification-toast {
    @apply fixed top-4 right-4 max-w-sm w-full bg-white dark:bg-gray-800 rounded-xl p-4 shadow-2xl z-50 backdrop-blur-xl;
    animation: slideIn 0.3s ease-out;
  }

  .status-running {
    @apply inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-300 border border-green-200 dark:border-green-700;
  }

  .status-completed {
    @apply inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-300 border border-blue-200 dark:border-blue-700;
  }

  .status-error {
    @apply inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-red-100 dark:bg-red-900/30 text-red-800 dark:text-red-300 border border-red-200 dark:border-red-700;
  }

  .status-idle {
    @apply inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-gray-100 dark:bg-gray-700/30 text-gray-800 dark:text-gray-300 border border-gray-200 dark:border-gray-600;
  }

  .progress-bar {
    @apply relative h-4 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden shadow-inner;
  }

  .progress-fill {
    @apply h-full transition-all duration-700 ease-out relative;
    background: linear-gradient(90deg, #3b82f6, #8b5cf6, #06b6d4);
    background-size: 200% 100%;
    animation: shimmer 2s infinite;
  }

  .form-group {
    @apply space-y-2;
  }

  .form-label {
    @apply block text-sm font-medium text-gray-700 dark:text-gray-300;
  }

  .form-input {
    @apply w-full px-4 py-3 rounded-xl border border-gray-300 dark:border-gray-600 bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm focus:ring-4 focus:ring-blue-500/30 focus:border-blue-500 transition-all duration-200;
  }

  .btn-secondary {
    @apply inline-flex items-center justify-center px-6 py-3 text-sm font-semibold rounded-xl bg-gradient-to-r from-gray-600 to-gray-700 hover:from-gray-700 hover:to-gray-800 text-white transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed;
  }

  .neon-glow {
    box-shadow: 0 0 20px rgba(59, 130, 246, 0.5), 0 0 40px rgba(59, 130, 246, 0.3);
  }

  .neon-glow-green {
    box-shadow: 0 0 20px rgba(34, 197, 94, 0.5), 0 0 40px rgba(34, 197, 94, 0.3);
  }

  .hover-lift:hover {
  /* disabled transform lift globally to avoid CoreAnimation warnings on macOS */
  }

  .tab-btn {
    @apply px-4 py-2 text-sm font-medium rounded-lg transition-all duration-200;
  }

  .tab-btn.active {
    @apply bg-blue-600 text-white;
  }

  .tab-btn:not(.active) {
    @apply bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600;
  }

  .close-btn {
    @apply absolute top-4 right-4 w-8 h-8 flex items-center justify-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 bg-gray-100 dark:bg-gray-800 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors;
  }

  .tab-focus-animation {
    animation: focusRingFadeOut 2s ease-out forwards;
  }

  @keyframes focusRingFadeOut {
    0% {
      box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.75);
    }
    100% {
      box-shadow: 0 0 0 2px rgba(59, 130, 246, 0);
    }
  }

  @keyframes slideUp {
    from {
      opacity: 0;
      transform: translateY(10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes scaleIn {
    from {
      opacity: 0;
      transform: scale(0.95);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }

  @keyframes fadeIn {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  .animate-slide-up {
    animation: slideUp 0.3s ease-out;
  }

  .animate-scale-in {
    animation: scaleIn 0.2s ease-out;
  }

  .animate-fade-in {
    animation: fadeIn 0.3s ease-out;
  }

  .floating {
    animation: float 3s ease-in-out infinite;
  }

  @keyframes float {
    0%, 100% {
      transform: translateY(0px);
    }
    50% {
      transform: translateY(-5px);
    }
  }
}

/* Keyframe animations */
@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Horizontal shake for attention (e.g., downshift badge) */
@keyframes shakeX {
  0%, 100% { transform: translateX(0); }
  25% { transform: translateX(-2px); }
  75% { transform: translateX(2px); }
}

.shake-x {
  animation: shakeX 0.35s ease-in-out 1;
}

@keyframes slideUp {
  from {
    opacity: 0;
    transform: translateY(30px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes slideIn {
  from {
    opacity: 0;
    transform: translateX(100%);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

@keyframes shimmer {
  0% {
    background-position: 200% 0;
  }
  100% {
    background-position: -200% 0;
  }
}

/* Accordion (height/opacity) */
@keyframes accordionIn {
  from { opacity: 0; transform: translateY(-4px); }
  to { opacity: 1; transform: translateY(0); }
}
.accordion-in { animation: accordionIn 0.25s ease-out; }

/* Button ripple (basic) */
.ripple {
  position: relative;
  overflow: hidden;
}
.ripple::after {
  content: '';
  position: absolute;
  inset: 0;
  background: radial-gradient(circle, rgba(255,255,255,0.35) 10%, rgba(255,255,255,0) 70%);
  transform: scale(0);
  opacity: 0;
}
.ripple:active::after {
  transition: transform 0.35s ease-out, opacity 0.45s ease-out;
  transform: scale(4);
  opacity: 1;
}

/* Custom utility classes */
.animate-fade-in {
  animation: fadeIn 0.5s ease-out;
}

/* Respect user preferences to reduce motion */
@media (prefers-reduced-motion: reduce) {
  * {
    animation: none !important;
    transition: none !important;
  }
}

.animate-slide-up {
  animation: slideUp 0.6s ease-out;
}

/* Subtle one-shot pulse without box-shadow (avoids CoreAnimation shadowOffset warnings on macOS) */
.pulse-once {
  animation: borderPulseOnce 0.6s ease-out;
}

@keyframes borderPulseOnce {
  0% {
    border-color: rgba(99, 102, 241, 0.55); /* indigo-500 */
  }
  100% {
    border-color: rgba(99, 102, 241, 0);
  }
}

/* Quick green flash (used for persist summary update) */
.flash-save {
  animation: flashSave 0.8s ease-out;
}

@keyframes flashSave {
  0% {
    background-color: rgba(16, 185, 129, 0.22); /* emerald-500 */
  }
  100% {
    background-color: transparent;
  }
}

/* Subtle blue flash for DB snapshot updates */
.flash-db {
  animation: flashDb 0.8s ease-out;
}

@keyframes flashDb {
  0% {
    background-color: rgba(2, 132, 199, 0.18); /* sky-600 */
  }
  100% {
    background-color: transparent;
  }
}

  /* ===================== */
  /* Start button wave FX  */
  /* ===================== */
  .start-wave-root {
    position: fixed;
    inset: 0;
    pointer-events: none;
    z-index: 9999;
  }
  .start-wave-circle {
    position: absolute;
    top: var(--y, 50%);
    left: var(--x, 50%);
    width: 24px;
    height: 24px;
    transform: translate(-50%, -50%) scale(0);
    border-radius: 9999px;
    background: radial-gradient(circle at center, rgba(59, 130, 246, 0.35), rgba(99, 102, 241, 0.2) 40%, rgba(59, 130, 246, 0.05) 70%, rgba(59, 130, 246, 0) 80%);
    filter: blur(2px);
    will-change: transform, opacity;
  }
  .start-wave-circle.wave-up { animation: waveBurstUp 900ms cubic-bezier(.2,.7,.2,1) forwards; }
  .start-wave-circle.wave-down { animation: waveBurstDown 900ms cubic-bezier(.2,.7,.2,1) forwards; }
  .start-wave-circle.wave-ring { animation: waveRing 950ms ease-out forwards; background: transparent; border: 2px solid rgba(59, 130, 246, 0.5); }

  @keyframes waveBurstUp {
    0% { opacity: 0.65; transform: translate(-50%, -50%) scale(0); }
    60% { opacity: 0.5; }
    100% { opacity: 0; transform: translate(-50%, calc(-50% - 20vh)) scale(var(--scale, 45)); }
  }
  @keyframes waveBurstDown {
    0% { opacity: 0.65; transform: translate(-50%, -50%) scale(0); }
    60% { opacity: 0.5; }
    100% { opacity: 0; transform: translate(-50%, calc(-50% + 20vh)) scale(var(--scale, 45)); }
  }
  @keyframes waveRing {
    0% { opacity: 0.9; transform: translate(-50%, -50%) scale(0.2); border-color: rgba(59, 130, 246, 0.6); }
    70% { opacity: 0.25; }
    100% { opacity: 0; transform: translate(-50%, -50%) scale(calc(var(--scale, 45) * 1.2)); border-color: rgba(59, 130, 246, 0); }
  }

  .start-wave-wash {
    position: absolute;
    inset: 0;
    background: radial-gradient(1200px 600px at var(--x, 50%) var(--y, 50%), rgba(99,102,241,0.08), rgba(59,130,246,0.04) 40%, rgba(59,130,246,0) 70%);
    animation: waveWash 900ms ease-out forwards;
  }
  @keyframes waveWash {
    0% { opacity: 0.4; }
    100% { opacity: 0; }
  }


  /* Dramatic transition for Calculated Range (no transform/box-shadow to avoid CA warnings) */
  .range-transition-ring { position: relative; isolation: isolate; }
  .range-transition-ring::after {
    content: '';
    position: absolute;
    inset: -6px;
    border: 3px solid rgba(59, 130, 246, 0.55); /* sky/indigo tone */
    border-radius: 12px;
    pointer-events: none;
    opacity: 0.85;
    animation: ringBorderPulse 900ms ease-out 1 both;
  }
  @keyframes ringBorderPulse {
    0%   { opacity: 0.85; }
    70%  { opacity: 0.18; }
    100% { opacity: 0; }
  }

  .shatter-line {
    display: inline-block;
    will-change: opacity;
  }
  .shatter-char {
    display: inline-block;
    will-change: opacity, filter, letter-spacing;
    animation: shatterFade 600ms cubic-bezier(.15,.85,.25,1) forwards;
  }

  @keyframes shatterFade {
    0% { opacity: 1; filter: none; letter-spacing: 0; }
    35% { opacity: 0.6; filter: blur(0.5px); letter-spacing: 0.5px; }
    100% { opacity: 0; filter: blur(1px); letter-spacing: 1px; }
  }

  .drum-line { display: inline-flex; }
  .drum-in {
    display: inline-block;
    will-change: opacity, filter;
    animation: drumFade 750ms cubic-bezier(.2,.8,.2,1) forwards;
    animation-delay: var(--delay, 0ms);
  }

  @keyframes drumFade {
    0% { opacity: 0; filter: blur(2px); }
    55% { opacity: 1; filter: blur(1px); }
    100% { opacity: 1; filter: none; }
  }

  /* Simple CSS confetti pieces (fallback to CSS if no canvas) */
  .confetti-piece {
    position: absolute;
    width: var(--cw, 6px); height: var(--ch, 10px);
    border-radius: 1px;
    opacity: 0;
    will-change: opacity, filter;
    animation: confettiShimmer 850ms cubic-bezier(.15,.85,.25,1) forwards;
  }

  @keyframes confettiShimmer {
    0% { opacity: 0; filter: none; }
    20% { opacity: 1; filter: blur(0.2px); }
    100% { opacity: 0; filter: blur(0.6px); }
  }